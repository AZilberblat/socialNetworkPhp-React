{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\completedCode\\\\tic-tac-toe\\\\client\\\\src\\\\components\\\\Game.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { calculateWinner } from \"../helper\";\nimport Board from \"./Board\";\nimport queryString from \"query-string\";\nimport PropTypes from \"prop-types\";\nimport io from \"socket.io-client\";\n\nconst Game = ({\n  location,\n  history\n}) => {\n  if (!localStorage.username) history.push(\"/login\");\n  const values = queryString.parse(location.search);\n  const [ghistory, setHistory] = useState([Array(9).fill(null)]);\n  const [stepNumber, setStepNumber] = useState(0);\n  const [xIsNext, setXisNext] = useState(true);\n  const [socket, setSocket] = useState(0);\n  const winner = calculateWinner(ghistory[stepNumber]);\n  const xO = xIsNext && localStorage.username ? localStorage.username[0] : localStorage.vs && localStorage.vs[0];\n  const [join, setJoin] = useState(0);\n  useEffect(() => {\n    setSocket(io(\"http://localhost:5000/\"));\n  }, []);\n\n  if (socket && !join) {\n    const id = localStorage.username;\n    const myData = [localStorage.username, localStorage.vs];\n    const myroom = myData.sort()[0] + \"\" + myData.sort()[1];\n    socket.emit(\"join\", {\n      myroom,\n      id\n    }, error => {\n      console.log(error);\n    });\n    setJoin(true);\n    console.log(\"heor\");\n  }\n\n  if (socket) {\n    socket.on(\"message\", mess => {\n      if (mess.other === localStorage.username) {\n        setHistory(mess.ghistory);\n        setStepNumber(mess.stepNumber);\n        setXisNext(mess.vs);\n        console.log(\"sdf\");\n      }\n    });\n  }\n\n  const handleClick = async i => {\n    const id = localStorage.username;\n    const other = localStorage.vs;\n    const myData = [localStorage.username, localStorage.vs];\n    const myroom = myData.sort()[0] + \"\" + myData.sort()[1];\n    const historyPoint = ghistory.slice(0, stepNumber + 1);\n    const current = historyPoint[stepNumber];\n    const squares = [...current]; // return if won or occupied\n\n    if (winner || squares[i]) return; // select square\n\n    squares[i] = xO;\n    await setHistory([...historyPoint, squares]);\n    await setStepNumber(historyPoint.length);\n    await setXisNext(!xIsNext);\n    const vs = xIsNext;\n    const tuple = {\n      ghistory: [...historyPoint, squares],\n      vs: true,\n      stepNumber: stepNumber + 1,\n      id,\n      myroom,\n      other\n    };\n    socket.emit(\"sendMessage\", tuple, () => console.log(\"done\"));\n  };\n\n  const jumpTo = step => {\n    setStepNumber(step);\n    setXisNext(step % 2 === 0);\n  };\n\n  const renderMoves = () => ghistory.map((_step, move) => {\n    const destination = move ? `Go to move #${move}` : \"Go to Start\";\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: move,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => jumpTo(move),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }\n    }, destination));\n  });\n\n  const logout = () => {\n    localStorage.removeItem(\"username\");\n    localStorage.removeItem(\"vs\");\n    history.push(\"/login\");\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }\n  }, localStorage.username && localStorage.username.toUpperCase() + \" vs \" + localStorage.vs.toUpperCase()), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-2 col-xs-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: logout,\n    className: \"btn btn-primary mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, \"logout\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-7 col-xs-7\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }\n  }, xIsNext ? /*#__PURE__*/React.createElement(Board, {\n    squares: ghistory[stepNumber],\n    onClick: handleClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(Board, {\n    squares: ghistory[stepNumber],\n    onClick: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-3 col-xs-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"info-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 15\n    }\n  }, \"History\"), renderMoves()), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }, winner ? \"Winner: \" + winner : \"Next Player: \" + xO)))));\n};\n\nGame.propTypes = {\n  location: PropTypes.object,\n  history: PropTypes.object\n};\nexport default Game;","map":{"version":3,"sources":["C:/xampp/htdocs/completedCode/tic-tac-toe/client/src/components/Game.js"],"names":["React","useState","useEffect","calculateWinner","Board","queryString","PropTypes","io","Game","location","history","localStorage","username","push","values","parse","search","ghistory","setHistory","Array","fill","stepNumber","setStepNumber","xIsNext","setXisNext","socket","setSocket","winner","xO","vs","join","setJoin","id","myData","myroom","sort","emit","error","console","log","on","mess","other","handleClick","i","historyPoint","slice","current","squares","length","tuple","jumpTo","step","renderMoves","map","_step","move","destination","logout","removeItem","toUpperCase","propTypes","object"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { calculateWinner } from \"../helper\";\r\nimport Board from \"./Board\";\r\nimport queryString from \"query-string\";\r\nimport PropTypes from \"prop-types\";\r\nimport io from \"socket.io-client\";\r\nconst Game = ({ location, history }) => {\r\n  if (!localStorage.username) history.push(\"/login\");\r\n  const values = queryString.parse(location.search);\r\n  const [ghistory, setHistory] = useState([Array(9).fill(null)]);\r\n  const [stepNumber, setStepNumber] = useState(0);\r\n  const [xIsNext, setXisNext] = useState(true);\r\n  const [socket, setSocket] = useState(0);\r\n  const winner = calculateWinner(ghistory[stepNumber]);\r\n  const xO =\r\n    xIsNext && localStorage.username\r\n      ? localStorage.username[0]\r\n      : localStorage.vs && localStorage.vs[0];\r\n  const [join, setJoin] = useState(0);\r\n  useEffect(() => {\r\n    setSocket(io(\"http://localhost:5000/\"));\r\n  }, []);\r\n\r\n  if (socket && !join) {\r\n    const id = localStorage.username;\r\n    const myData = [localStorage.username, localStorage.vs];\r\n    const myroom = myData.sort()[0] + \"\" + myData.sort()[1];\r\n    socket.emit(\"join\", { myroom, id }, (error) => {\r\n      console.log(error);\r\n    });\r\n    setJoin(true);\r\n    console.log(\"heor\");\r\n  }\r\n  if (socket) {\r\n    socket.on(\"message\", (mess) => {\r\n      if (mess.other === localStorage.username) {\r\n        setHistory(mess.ghistory);\r\n        setStepNumber(mess.stepNumber);\r\n        setXisNext(mess.vs);\r\n        console.log(\"sdf\");\r\n      }\r\n    });\r\n  }\r\n\r\n  const handleClick = async (i) => {\r\n    const id = localStorage.username;\r\n    const other = localStorage.vs;\r\n    const myData = [localStorage.username, localStorage.vs];\r\n    const myroom = myData.sort()[0] + \"\" + myData.sort()[1];\r\n    const historyPoint = ghistory.slice(0, stepNumber + 1);\r\n    const current = historyPoint[stepNumber];\r\n    const squares = [...current];\r\n    // return if won or occupied\r\n    if (winner || squares[i]) return;\r\n    // select square\r\n\r\n    squares[i] = xO;\r\n    await setHistory([...historyPoint, squares]);\r\n    await setStepNumber(historyPoint.length);\r\n    await setXisNext(!xIsNext);\r\n    const vs = xIsNext;\r\n    const tuple = {\r\n      ghistory: [...historyPoint, squares],\r\n      vs: true,\r\n      stepNumber: stepNumber + 1,\r\n      id,\r\n      myroom,\r\n      other,\r\n    };\r\n\r\n    socket.emit(\"sendMessage\", tuple, () => console.log(\"done\"));\r\n  };\r\n\r\n  const jumpTo = (step) => {\r\n    setStepNumber(step);\r\n    setXisNext(step % 2 === 0);\r\n  };\r\n\r\n  const renderMoves = () =>\r\n    ghistory.map((_step, move) => {\r\n      const destination = move ? `Go to move #${move}` : \"Go to Start\";\r\n      return (\r\n        <li key={move}>\r\n          <button onClick={() => jumpTo(move)}>{destination}</button>\r\n        </li>\r\n      );\r\n    });\r\n  const logout = () => {\r\n    localStorage.removeItem(\"username\");\r\n    localStorage.removeItem(\"vs\");\r\n    history.push(\"/login\");\r\n  };\r\n  return (\r\n    <>\r\n      <h1>\r\n        {localStorage.username &&\r\n          localStorage.username.toUpperCase() +\r\n            \" vs \" +\r\n            localStorage.vs.toUpperCase()}\r\n      </h1>\r\n      <div className=\"row\">\r\n        <div className=\"col-md-2 col-xs-2\">\r\n          <button onClick={logout} className=\"btn btn-primary mb-3\">\r\n            logout\r\n          </button>\r\n        </div>\r\n        <div className=\"col-md-7 col-xs-7\">\r\n          {xIsNext ? (\r\n            <Board squares={ghistory[stepNumber]} onClick={handleClick} />\r\n          ) : (\r\n            <Board squares={ghistory[stepNumber]} onClick={false} />\r\n          )}\r\n        </div>\r\n        <div className=\"col-md-3 col-xs-3\">\r\n          <div className=\"info-wrapper\">\r\n            <div>\r\n              <h3>History</h3>\r\n              {renderMoves()}\r\n            </div>\r\n            <h3>{winner ? \"Winner: \" + winner : \"Next Player: \" + xO}</h3>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\nGame.propTypes = {\r\n  location: PropTypes.object,\r\n  history: PropTypes.object,\r\n};\r\nexport default Game;\r\n"]},"metadata":{},"sourceType":"module"}